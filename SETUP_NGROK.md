# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –∑–∞–ø—É—Å–∫ —Å ngrok

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env`
2. ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è ngrok
3. ‚úÖ Cookie –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è HTTPS (secure=true, samesite=none)
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram WebApp

## üìã –®–∞–≥–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞:

### 1Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ backend —Å–µ—Ä–≤–µ—Ä:

```bash
cd /home/user/fesgr/backend
python3 -m uvicorn main:app --host 0.0.0.0 --port 8001 --reload
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–µ—Ä Muji –Ω–∞ –ø–æ—Ä—Ç—É 8001...
INFO:     Uvicorn running on http://0.0.0.0:8001
```

### 2Ô∏è‚É£ –í –î–†–£–ì–û–ú —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ ngrok:

```bash
ngrok http 8001
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: `https://pinkly-unfermentable-magen.ngrok-free.dev`)

### 3Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Telegram –±–æ—Ç–∞:

**–í–ê–ñ–ù–û:** –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Web App:

```
1. –û—Ç–∫—Ä–æ–π—Ç–µ @BotFather –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É: /mybots
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
4. –í—ã–±–µ—Ä–∏—Ç–µ: "Bot Settings" ‚Üí "Menu Button"
5. –í—ã–±–µ—Ä–∏—Ç–µ: "Configure menu button"
6. –í–≤–µ–¥–∏—Ç–µ URL: https://pinkly-unfermentable-magen.ngrok-free.dev
7. –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏: "Open App"
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ Web App):**
```
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ: /newapp
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ: Muzo Dating
4. –í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ: Anonymous dating app
5. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ (–ª—é–±–æ–µ 640x360)
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –¥–µ–º–æ GIF –∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç–µ
7. –í–≤–µ–¥–∏—Ç–µ URL: https://pinkly-unfermentable-magen.ngrok-free.dev
8. –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è: muzo
```

### 4Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:**
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram
- –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É Menu (–∏–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É, –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ Web App –≤–Ω—É—Ç—Ä–∏ Telegram

**‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:**
- –ù–ï –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–æ—Å—Ç–æ ngrok URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å—Å—ã–ª–∫—É –≤ —á–∞—Ç –∏ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –µ—ë

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:

```javascript
=== TELEGRAM DEBUG ===
tg.initData: query_id=...&user=...&auth_date=...&hash=...
tg.initDataUnsafe: {user: {...}, auth_date: ...}
telegramUser: {id: 123456789, first_name: "John", ...}
======================

=== AUTHENTICATION DEBUG ===
tg: {initData: "...", ...}
tg?.initData: "query_id=...&user=..."
============================

üîê Authenticating with Telegram...
‚úÖ Telegram authentication successful
```

### –í –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:

```
‚úÖ Telegram user authenticated: 123456789 (John Doe)
```

### –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏:

**‚ùå "initData not available"** ‚Üí –í—ã –æ—Ç–∫—Ä—ã–ª–∏ –ù–ï —á–µ—Ä–µ–∑ Web App
**‚ùå "Invalid Telegram authentication"** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `.env`
**‚ùå "401 Unauthorized"** ‚Üí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞

## üéØ –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

–í—Å–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –æ–ø–ª–∞—Ç—ã
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –ß–∞—Ç—ã –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üîß –ï—Å–ª–∏ –≤—Å—ë –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä** (Ctrl+C –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞)
2. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** –≤ Telegram (–∑–∞–∫—Ä–æ–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–Ω–æ–≤–æ)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω** –≤ `/home/user/fesgr/backend/.env`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏

## üì± –í–∞–∂–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω –ª–∏ —Å–µ—Ä–≤–µ—Ä:
lsof -i :8001

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞:
# –û–Ω–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω uvicorn

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª:
cat /home/user/fesgr/backend/.env | grep TELEGRAM_BOT_TOKEN
```

## ‚ö†Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

- ‚úÖ `.env` —Ñ–∞–π–ª –≤ `.gitignore` (—Ç–æ–∫–µ–Ω –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git)
- ‚úÖ HTTPS —á–µ—Ä–µ–∑ ngrok
- ‚úÖ HttpOnly cookies
- ‚úÖ HMAC-SHA256 –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è Telegram –¥–∞–Ω–Ω—ã—Ö

## üÜò –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ—Å—Ç–∞–ª–∏—Å—å:

–ü–æ–∫–∞–∂–∏—Ç–µ:
1. –õ–æ–≥–∏ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)
2. –õ–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ (—Ç–µ—Ä–º–∏–Ω–∞–ª —Å uvicorn)
3. –ö–∞–∫ –≤—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ –±–æ—Ç–∞ –∏–ª–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä?)
